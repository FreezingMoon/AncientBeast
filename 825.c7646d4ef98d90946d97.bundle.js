"use strict";(self.webpackChunkancientbeast=self.webpackChunkancientbeast||[]).push([[825],{68825:(e,t,r)=>{r.r(t),r.d(t,{default:()=>m});var i=r(4942),a=r(70885),n=r(42982),s=r(16255),c=r(83355),o=r(23315),u=r(67790),h=r(68861),f=r(56865);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const m=function(e){e.abilities[6]=[{trigger:"onCreatureSummon onOtherCreatureSummon onOtherCreatureDeath",_buff:0,require:function(){if(this.creature.dead||this.creature.temp)return!1;var t=0;return e.creatures.forEach((function(e){"S"!=e.realm||e.dead||e.temp||(t+=2)})),t!=this._buff&&(this._buff=t,!0)},activate:function(){this.creature.facePlayerDefault();var t=0;this.isUpgraded()&&(t=this._buff),this.creature.replaceEffect(new h.Q("Lamellar Body",this.creature,this.creature,"",{alterations:{defense:this._buff,frost:this._buff,regrowth:t},stackable:!1},e))}},{trigger:"onQuery",_directions:[0,1,0,0,1,0],_targetTeam:c.S.Enemy,_executeHealthThreshold:39,require:function(){if(!this.testRequirements())return!1;if(!this.atLeastOneTarget(this._getHexes(),{team:this._targetTeam})){if(!this.isUpgraded())return!1;if(!this.testDirection({team:this._targetTeam,directions:this._directions,distance:this.creature.remainingMove+1,sourceCreature:this.creature}))return!1}return!0},query:function(){var t=this,r=this.creature,i={fnOnConfirm:function(){t.animation.apply(t,arguments)},flipped:r.player.flipped,id:r.id,team:c.S.Enemy,requireCreature:!0};if(i.choices=this._getHexes().map((function(e){return[e]})),this.isUpgraded()){var a=e.grid.getDirectionChoices({flipped:r.player.flipped,team:this._targetTeam,requireCreature:!0,stopOnCreature:!0,sourceCreature:r,id:r.id,x:r.x,y:r.y,directions:this._directions,distance:r.remainingMove+1});i.choices=i.choices.filter((function(e){return!a.choices.some((function(t){return e.every((function(e){return t.includes(e)}))}))})),i.choices=[].concat((0,n.Z)(i.choices),(0,n.Z)(a.choices))}e.grid.queryChoice(i)},activate:function(t,r){var i=this,a=i.creature;e.Phaser.camera.shake(.02,333,!0,e.Phaser.camera.SHAKE_HORIZONTAL,!0),i.end(),t=u.n(t,r.direction);var n=u.Z$(t).creature;if(this._getHexes().some((function(e){var t;return(null===(t=e.creature)||void 0===t?void 0:t.id)===n.id})))i._damageTarget(n);else{u.B0(t,!1,!0,a.id);var s=u.Z$(t),c=s.x+(4===r.direction?a.size-1:0);s=e.grid.hexes[s.y][c];var o=e.grid.getHexLine(n.x,n.y,r.direction);u.B0(o,!1,!0,n.id),o=o.slice(0,t.length),a.moveTo(s,{overrideSpeed:100,callback:function(){var t=u.Z$(o);i._damageTarget(n).kill||(t?(r.direction===f.N.Left&&(t=t&&e.grid.hexes[t.y][t.x+n.size-1]),n.moveTo(t,{callback:function(){e.activeCreature.queryMove()},ignoreMovementPoint:!0,ignorePath:!0,animation:"push"})):e.activeCreature.queryMove())}})}},_damageTarget:function(t){var r,i=t.health<=this._executeHealthThreshold&&t.isFrozen(),a=i?{pure:t.health}:{crush:this.damages.crush,frost:this.damages.frost},n=new s.h(this.creature,a,1,[],e);return i?(this.game.UI.chat.suppressMessage(/is dead/i,1),(r=t.takeDamage(n)).kill&&(this.game.log("%CreatureName".concat(t.id,"% has been shattered!")),t.hint("Shattered","damage"))):r=t.takeDamage(n),r},_getHexes:function(){return this.creature.getHexMap(o.LY)}},{trigger:"onQuery",_targetTeam:c.S.Enemy,_directions:[1,1,1,1,1,1],_distance:5,require:function(){return!!this.testRequirements()&&!!this.testDirection({sourceCreature:this.creature,team:this._targetTeam,directions:this._directions,distance:this._distance,optTest:this._confirmTarget})},query:function(){var t=this,r=this.creature;e.grid.queryDirection({fnOnConfirm:function(){t.animation.apply(t,arguments)},flipped:r.player.flipped,team:this._targetTeam,id:r.id,requireCreature:!0,x:r.x,y:r.y,directions:this._directions,distance:this._distance,optTest:this._confirmTarget})},activate:function(t,r){var i=this,n=this.creature,c=u.Z$(t).creature;i.end(),e.Phaser.camera.shake(.01,50,!0,e.Phaser.camera.SHAKE_HORIZONTAL,!0);var o=e.animations.projectile(this,c,"effects_freezing-spit",t,r,52,-20),h=(0,a.Z)(o,2),f=h[0],d=h[1],g=Math.max(n.stats.frost-c.stats.frost,0),m=new s.h(i.creature,{frost:g},1,[],e);f.onComplete.add((function(){var t;this.destroy(),m.damages.frost>0&&(t=c.takeDamage(m)),c.freeze(i.isUpgraded()),t&&!t.kill&&(e.log("%CreatureName".concat(c.id,"% ").concat(i.isUpgraded()?"enters Cryostasis":"has been Frozen"," and cannot act")),c.hint(i.isUpgraded()?"Cryostasis":"Frozen"))}),d)},_confirmTarget:function(e){return e.isFatigued()}},{trigger:"onQuery",_directions:[0,1,0,0,1,0],_targetTeam:c.S.Enemy,require:function(){return this.creature,!!this.testRequirements()&&!!this.atLeastOneTarget(this._getHexes(),{team:this._targetTeam})},query:function(){var e=this,t=this.creature;this.game.grid.queryCreature({fnOnConfirm:function(){e.animation.apply(e,arguments)},team:this._targetTeam,id:t.id,flipped:t.flipped,hexes:this._getHexes()})},activate:function(t){var r=this,i=this.creature;r.end(),e.Phaser.camera.shake(.02,123,!0,e.Phaser.camera.SHAKE_VERTICAL,!0);var a=Math.max(i.level-t.level,0),n=g(g({},r.damages),{},{frost:r.damages.frost+a*r.bonus_damages.frost,pierce:r.damages.pierce+(r.isUpgraded()?a*r.bonus_damages.pierce:0)}),c=new s.h(i,n,1,[],e);t.takeDamage(c)},_getHexes:function(){var t=this.creature;return[].concat((0,n.Z)(e.grid.getHexMap(t.x,t.y-4,2,!0,o.mA)),(0,n.Z)(this.creature.getHexMap(o.mA)))}}]}},68861:(e,t,r)=>{r.d(t,{Q:()=>c});var i=r(15671),a=r(43144),n=r(19755),s=r(65482),c=function(){function e(t,r,a,s,c,o){(0,i.Z)(this,e),this.id=o.effectId++,this.game=o,this.name=t,this.owner=r,this.target=a,this.trigger=s,this.creationTurn=o.turn;var u=n.extend({requireFn:function(){return!0},effectFn:function(){},alterations:{},turnLifetime:0,deleteTrigger:"onStartOfRound",stackable:!0,noLog:!1,specialHint:void 0,deleteOnOwnerDeath:!1},c);n.extend(this,u),o.effects.push(this)}return(0,a.Z)(e,[{key:"animation",value:function(){this.activate.apply(this,arguments)}},{key:"activate",value:function(e){if(!this.requireFn(e))return!1;this.noLog||console.log("Effect "+this.name+" triggered"),e instanceof s.j&&e.addEffect(this),this.effectFn(this,e)}},{key:"deleteEffect",value:function(){var e=this.target.effects.indexOf(this);this.target.effects[e]?this.target.effects.splice(e,1):console.warn("Failed to find effect on target.",this);var t=this.game.effects.indexOf(this);this.game.effects[t]?this.game.effects.splice(t,1):console.warn("Failed to find effect on game.",this),this.target.updateAlteration()}}]),e}()}}]);