"use strict";(self.webpackChunkancientbeast=self.webpackChunkancientbeast||[]).push([[21],{36021:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var i=r(42982),a=r(16255),n=r(83355),s=(r(56865),r(23315)),f=(r(67790),r(68861));const c=function(e){e.abilities[28]=[{triggerFunc:function(){return this.isUpgraded()?"onStartPhase onDamage":"onStartPhase"},_defenseBuff:0,_maxDefenseBuff:40,_damageTaken:!1,_getDefenseBuff:function(e){return this._defenseBuff>=39?this._defenseBuff=40:this.isUpgraded()&&!this._damageTaken?this._defenseBuff+=2:this._defenseBuff+=1,this._defenseBuff},require:function(e){return!e||(this._damageTaken=!0,!1)},activate:function(){this.creature.replaceEffect(new f.Q("Tankish Build",this.creature,this.creature,"",{alterations:{defense:this._getDefenseBuff(this._defenseBuff)},stackable:!1},e)),this._damageTaken=!1}},{trigger:"onQuery",_targetTeam:n.S.Enemy,require:function(){var e={team:this._targetTeam,sourceCreature:this.creature,distance:3};return!(!this.testRequirements()||!this.testDirection(e))},query:function(){var t=this.creature,r=this;this.isUpgraded()?e.grid.queryDirection({fnOnConfirm:function(){if(arguments[1].hex.creature)r.animation([arguments[1].hex],arguments[1],arguments[2]);else{for(var e=[],t=0;t<arguments[0].length;t++)if(arguments[0][t].creature){e.push(arguments[0][t]);break}r.animation(e,arguments[1],arguments[2])}},flipped:t.player.flipped,team:this._targetTeam,id:t.id,requireCreature:!0,x:t.x,y:t.y,distance:3,sourceCreature:t,stopOnCreature:!1,dashedHexesUnderCreature:!0}):e.grid.queryDirection({fnOnConfirm:function(){r.animation.apply(r,arguments)},flipped:t.player.flipped,team:this._targetTeam,id:t.id,requireCreature:!0,x:t.x,y:t.y,distance:3,sourceCreature:t,dashedHexesUnderCreature:!0})},activate:function(t){var r=this;if(r.end(),this.isUpgraded()){var i=new Set;t.forEach((function(e){var t=e.creature;t&&i.add(t)})),i.forEach((function(t){var i=new a.h(r.creature,r.damages,1,[],e);e.Phaser.camera.shake(.03,400,!0,e.Phaser.camera.SHAKE_VERTICAL,!0),t.takeDamage(i)}))}else{var n=new a.h(r.creature,r.damages,1,[],e);t=t.find((function(e){return e.creature})).creature,e.Phaser.camera.shake(.03,400,!0,e.Phaser.camera.SHAKE_VERTICAL,!0),t.takeDamage(n)}}},{trigger:"onQuery",_req:{team:n.S.Both,directions:[0,1,0,0,1,0],distance:1},_directions:[0,0,0,0,0,0],_getDashed:function(t){var r,i=this.creature;if(t[4])if(t[1]){var a=e.grid.getHexMap(i.x,i.y,0,i.player.flipped,s.hi),n=e.grid.getHexMap(i.x,i.y,0,!i.player.flipped,s.hi);r=a.concat(n)}else r=e.grid.getHexMap(i.x,i.y,0,!i.player.flipped,s.hi);else r=e.grid.getHexMap(i.x,i.y,0,i.player.flipped,s.hi);return r},_getTarget:function(t){var r=this,a=this.creature,n=a.player.flipped?a.x-2:a.x+1,s=a.player.flipped?a.x+1:a.x-2,f=[];return t[4]?t[1]?(f.push.apply(f,(0,i.Z)(r._getCreature(e.grid.getHexLine(n,a.y,1,a.player.flipped)))),f.push.apply(f,(0,i.Z)(r._getCreature(e.grid.getHexLine(s,a.y,4,a.player.flipped))))):f.push.apply(f,(0,i.Z)(r._getCreature(e.grid.getHexLine(s,a.y,4,a.player.flipped)))):f.push.apply(f,(0,i.Z)(r._getCreature(e.grid.getHexLine(n,a.y,1,a.player.flipped)))),f},_getCreature:function(t){for(var r=[],i=0,a=0;i<t.length&&a<2;){var n=t[i].creature;if(void 0!==n){for(var s=0;s<n.size;s++)r.push(e.grid.hexes[n.y][n.x-s]);i+=n.size,a=0}else i++,a++}return r},_checkEnd:function(){var t,r=this,i=this.creature,a=r.testDirections(r._req);r._directions=[0,0,0,0,0,0];var n=i.player.flipped?i.x-2:i.x+1,s=i.player.flipped?i.x+1:i.x-2;if(a[4])if(a[1]){var f=e.grid.getHexLine(n,i.y,1,i.player.flipped),c=e.grid.getHexLine(s,i.y,4,i.player.flipped);this._getHole(f)&&(r._directions[1]=1),this._getHole(c)&&(r._directions[4]=1)}else t=e.grid.getHexLine(s,i.y,4,i.player.flipped),this._getHole(t)&&(r._directions=a);else t=e.grid.getHexLine(n,i.y,1,i.player.flipped),this._getHole(t)&&(r._directions=a)},_getHole:function(e){for(var t=0,r=0;t<e.length&&r<2;)void 0===e[t].creature?r++:r=0,t++;return r>=2},require:function(){var e=this;return e._req.sourceCreature=e.creature,e._checkEnd(),!(!e.testRequirements()||!e._directions[1]&&!e._directions[4])},query:function(){var t=this,r=this.creature,i=t._directions,a=t._getDashed(i),s=t._getTarget(i),f=[];i[1]&&i[4]&&(f=s.filter((function(e){return e.x<r.x}))).forEach((function(e){s.splice(s.findIndex((function(t){return t.coord===e.coord})),1)})),e.grid.queryChoice({fnOnConfirm:function(){t.animation.apply(t,arguments)},team:n.S.Both,requireCreature:0,id:r.id,flipped:r.flipped,choices:[s,f],hexesDashed:a})},activate:function(t){var r=this,i=this.creature,n=0;r.end(),e.Phaser.camera.shake(.03,400,!0,e.Phaser.camera.SHAKE_VERTICAL,!0);var s=r.getTargets(t),f=s[s.length-1].target,c=null;for(n=0;n<s.length;n++){for(var u=s[n].target,d=new a.h(r.creature,r.damages,1,[],e),h=0;h<u.size&&(u.takeDamage(d),!0!==u.dead);h++);if(!r.isUpgraded()&&!0===u.dead&&(u.size>1||void 0===e.grid.hexes[u.y][u.x-1].creature||void 0===e.grid.hexes[u.y][u.x+1].creature)){n>0?f=s[n-1].target:(f=u,c=0);break}}null===c&&(c=f.x>=i.x?2:-f.size),r.creature.moveTo(e.grid.hexes[i.y][f.x+c],{ignoreMovementPoint:!0,ignorePath:!0,callback:function(){e.Phaser.camera.shake(.02,100,!0,e.Phaser.camera.SHAKE_VERTICAL,!0),e.onStepIn(r.creature,r.creature.hexagons[0]);var t=setInterval((function(){e.freezedInput||(clearInterval(t),e.UI.selectAbility(-1),e.activeCreature.queryMove())}),100)}})}},{trigger:"onQuery",map:[[0,0,1,0],[0,0,1,1],[0,1,1,0],[0,0,1,1],[0,0,1,0]],require:function(){return this.testRequirements()},query:function(){var t=this,r=this.creature;this.map.origin=[0,2],e.grid.queryChoice({fnOnConfirm:function(){t.animation.apply(t,arguments)},team:n.S.Both,requireCreature:0,id:r.id,flipped:r.flipped,choices:[r.getHexMap(this.map),r.getHexMap(this.map,!0)]})},activate:function(t){var r=this,i=this;i.end(),e.Phaser.camera.shake(.03,400,!0,e.Phaser.camera.SHAKE_VERTICAL,!0);for(var a=i.getTargets(t),n=function(){var t=a[s].target;i.isUpgraded()&&(t.delayed||t.findEffect("Earth Shaker").length>0)?(t.status.dizzy=!0,t.removeEffect("Earth Shaker")):(t.delay(!1),t.addEffect(new f.Q("Earth Shaker",r.creature,t,"onStartPhase",{effectFn:function(){t.delayed=!0,t.delayable=!1},deleteTrigger:"onEndPhase",turnLifetime:1,stackable:!1},e)))},s=0;s<a.length;s++)n()}}]}},68861:(e,t,r)=>{r.d(t,{Q:()=>f});var i=r(15671),a=r(43144),n=r(19755),s=r(65482),f=function(){function e(t,r,a,s,f,c){(0,i.Z)(this,e),this.id=c.effectId++,this.game=c,this.name=t,this.owner=r,this.target=a,this.trigger=s,this.creationTurn=c.turn;var u=n.extend({requireFn:function(){return!0},effectFn:function(){},alterations:{},turnLifetime:0,deleteTrigger:"onStartOfRound",stackable:!0,noLog:!1,specialHint:void 0,deleteOnOwnerDeath:!1},f);n.extend(this,u),c.effects.push(this)}return(0,a.Z)(e,[{key:"animation",value:function(){this.activate.apply(this,arguments)}},{key:"activate",value:function(e){if(!this.requireFn(e))return!1;this.noLog||console.log("Effect "+this.name+" triggered"),e instanceof s.j&&e.addEffect(this),this.effectFn(this,e)}},{key:"deleteEffect",value:function(){var e=this.target.effects.indexOf(this);this.target.effects[e]?this.target.effects.splice(e,1):console.warn("Failed to find effect on target.",this);var t=this.game.effects.indexOf(this);this.game.effects[t]?this.game.effects.splice(t,1):console.warn("Failed to find effect on game.",this),this.target.updateAlteration()}}]),e}()}}]);